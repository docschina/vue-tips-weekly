---
title: "🔥 (#77) Flatten Nuxt Content Routes"
head:
  - - link
    - rel: canonical
      href: https://michaelnthiessen.com/weekly-077-september-07/
---

# 🔥 (#77) Flatten Nuxt Content Routes

September 2022

Hey!

I'm currently in the thick of working on Mastering Nuxt 3, but I'm still taking some time to create other content, too.

It's a busy time for me, but I'm glad I get to work on exciting things!

I've also been migrating my blog over from Gridsome to Nuxt 3. It's a big, complicated project because there's lots of stuff happening with my site. But working with Nuxt is always a joy!

Should I write some posts about that migration?

My world is entirely Nuxt, so today, we're going with two Nuxt tips.

Have a great week!

— Michael

## 📜 Forcing Vue to Re-Render

I originally wrote this article 4 years ago, so it was certainly time for an update.

It was one of the first articles I ever wrote, and has been wildly popular with well over 500,000 people reading it.

Now I've updated it for Vue 3 and expanded it a bit.

[Read the article here](https://michaelnthiessen.com/force-re-render).

## 🔥 How to Fix the TypeScript Intellisense Template Error in Vue

I recently got this error while working on a Vue 3 project:

```
TypeScript intellisense is disabled on template. To enable, configure `"jsx": "preserve"` in the `"compilerOptions"` property of tsconfig or jsconfig. To disable this prompt instead, configure `"experimentalDisableTemplateSupport": true` in `"vueCompilerOptions"` property.volar
```

No need to panic, just disable this Volar message [exactly how it says](https://github.com/johnsoncodehk/volar/issues/1219#issuecomment-1104548432).

In your `.tsconfig` file you need to add `"jsx": "preserve"` in the `compilerOptions` section:

```javascript
{
  "compilerOptions": {
    "jsx": "preserve"
  }
}
```

I’m using Nuxt 3, so my TypeScript config file looks a little different:

```
{
  // https://v3.nuxtjs.org/concepts/typescript
  "extends": "./.nuxt/tsconfig.json",
  "compilerOptions": {
    "jsx": "preserve"
  }
}
```

If you’re using a [jsconfig](https://code.visualstudio.com/docs/languages/jsconfig#_jsconfig-options) file instead, it may look closer to this:

```
{
  "compilerOptions": {
    "module": "commonjs",
    "target": "es6",
    "jsx": "preserve"
  },
  "include": ["src/**/*"]
}
```

The `jsx` option on the `.tsconfig` [controls how ts transforms and outputs](https://www.typescriptlang.org/tsconfig#jsx) `.tsx` files, but this error happens on `.vue` files with no `tsx` extension.

So changing this option to silence the warning has no real effect on our projects. In Vue we are only using TypeScript for type checking so this option doesn’t affect anything that we’re doing.

This issue is likely happening because of the TypeScript Language Server that VS Code uses to provide the Intellisense feature. Volar hooks into this server, but unfortunately, has no control over it.

## 🔥 Flatten Nuxt Content Routes

I wanted to organize my blog content into several folders:

- Articles: `content/articles/`
- Newsletters: `content/newsletters/`

By default though, Nuxt Content would set up these routes to include those prefixes. But I want all of my routes to be at the root level:

- Articles: michaelnthiessen.com/my-latest-article
- Newsletters: michaelnthiessen.com/most-recent-newsletter

We can do this manually for each Markdown file by overriding the `_path` property through it's frontmatter:

```markdown
---
title: My Latest Article
date: today
_path: "/my-latest-article"
---
```

This is extremely tedious, error-prone, and generally annoying.

Luckily, we can write a simple Nitro plugin that will do this transform automatically.

Create a `content.ts` file in `server/plugins/`:

```javascript
export default defineNitroPlugin((nitroApp) => {
  nitroApp.hooks.hook("content:file:afterParse", (file) => {
    for (const prefix of ["/articles", "/newsletters"]) {
      if (file._path.startsWith(prefix)) {
        // Keep the prefix so we can query based on it still
        file._original_dir = prefix;
        // Remove prefix from path
        file._path = file._path.replace(prefix, "");
      }
    }
  });
});
```

Nitro is the server that Nuxt uses internally. We can hook into it's processing pipeline and do a bit of tweaking.

However, doing this breaks `queryContent` calls if we're filtering based on the path, since `queryContent` is looking at the `_path` property we've just modified. This is why we want to keep that original directory around.

We can modify our `queryContent` calls to filter on this new `_original_dir` property:

```javascript
// Before
queryContent("/articles");

// After
queryContent().where({
  _original_dir: { $eq: "/articles" },
});
```

Pro tip: use `nuxi clean` to force Nuxt Content to re-fetch and re-transform all of your content.

## 📜 Coding Better Composables: Options Object (3/5)

I teamed up with Vue Mastery to create this series on coding better composables.

In this series we cover five different patterns.

For each, we show how you can implement it and then we see it in action with a composable from VueUse.

This third article shows a simple way of making your return values more useful.

Read it here: [Coding Better Composables: Options Object (3/5)](https://www.vuemastery.com/blog/coding-better-composables-3-of-5)

## 💬 Principles of Programmer Productivity

"What one programmer can do in one month, two programmers can do in two months." —Fred Brooks

## 🧠 Spaced-repetition: The CSS Unselector

**The best way to commit something to long-term memory is to periodically review it, gradually increasing the time between reviews 👨‍🔬**

**Actually remembering these tips is much more useful than just a quick distraction, so here's a tip from a couple weeks ago to jog your memory.**

With CSS we often focus on how to get selectors to apply to only the specific elements that we’re targeting.

Part of this process is making sure the selector _does not_ select the wrong elements. This is often the hardest part!

My blog uses Vue Router, which applies the class `.router-link-active` to any link that links to the current route (the page we’re on right now). I then use this class to change the colour of the current link, to help the user know where they’re at.

But I wanted to make sure that all links _within_ the page do not get highlighted in the same way.

For example, a table of contents at the beginning of an article should have normal looking links, not the changed colour.

To do this I needed to avoid selecting all of the links with a `#` in the `href` attribute:

```css
.router-link-active: not([href * = "#" ]);
```

I’m using a `:not` query, but then using an attribute selector inside of that.

My actual code is even more fun, because there are a few other things going on that I need to account for:

```css
.nav-link.router-link-exact-active:not(.site-title):not([href*='#'])
```

_p.s. I also have three courses: [Vue Tips Collection](https://michaelnthiessen.com/vue-tips-collection), [Reusable Components](https://michaelnthiessen.com/reusable-components) and [Clean Components](https://michaelnthiessen.com/clean-components)_

## 来源

原文 https://michaelnthiessen.com/weekly-077-september-07/

本作品采用[知识共享署名-相同方式共享 4.0 国际许可协议](http://creativecommons.org/licenses/by-sa/4.0/)进行许可。

---
title: "ğŸ”¥ (#73) Nuxt Content Queries"
head:
  - - link
    - rel: canonical
      href: https://michaelnthiessen.com/weekly-073-august-10/
---

# ğŸ”¥ (#73) Nuxt å†…å®¹æŸ¥è¯¢

August 2022

Hey!

è¿™ä¸ªå¤å¤©å¯¹æˆ‘æ¥è¯´æœ‰ç‚¹å¿™ï¼Œæˆ‘ç»ˆäºå®Œæˆäº†æ‰€æœ‰çš„å©šç¤¼å’Œæ—…è¡Œã€‚

ç°åœ¨æˆ‘æœ‰æ—¶é—´æ¥ç»§ç»­è¾“å‡º Vue çš„å†…å®¹ã€‚

åœ¨æ¥ä¸‹æ¥çš„å‡ ä¸ªæœˆé‡Œï¼Œæˆ‘å°†æœ‰ä¸€äº›ä»¤äººå…´å¥‹çš„äº‹æƒ… - è¿™å°†æ˜¯å²è¯—èˆ¬çš„ï¼

æˆ‘ç°åœ¨çœŸä¸èƒ½è¯´å¤ªå¤šã€‚

æ˜¯çš„ï¼Œæˆ‘è¿˜åœ¨ç¼“æ…¢æ›´æ–° Clean Componentsï¼Œè¿™æ˜¯ä¸€ä¸ªä¸åŒçš„é¡¹ç›®ã€‚

ä½ è¿˜è¦ç­‰ç­‰

ç°åœ¨ï¼Œæˆ‘ä»¬ç»§ç»­ Vue Tips å†…å®¹ã€‚

â€”Michael

_p.s. If you love these newsletters I send out, please share it with a co-worker or friend who you think will also enjoy it! Thanks!_

## ğŸ”¥ ä»å†™æ¥å£ Interface å…¥æ‰‹

åœ¨ç¼–å†™å¯å¤ç”¨ç»„ä»¶æ—¶å€™ï¼Œä¸è¦ç«‹åˆ»å†™ä»£ç å®ç°å®ƒã€‚

ç›¸åï¼ŒèŠ±ä¸€äº›æ—¶é—´åˆ†æå‡ºä½ ä¼šç”¨åˆ°çš„ç»„ä»¶ã€‚èŠ±ä¸€äº›æ—¶é—´æ€è€ƒç»„ä»¶å’Œåº”ç”¨ä¹‹é—´çš„äº¤äº’æ¥å£ä¿¡æ¯ã€‚

æå‰å‡ åˆ†é’Ÿçš„å‡†å¤‡ï¼Œåç»­å¯ä»¥èŠ‚çœå¾ˆå¤šæ—¶é—´å’Œé£é™©ã€‚

å¼€å§‹ä¹‹å‰ä½ å¯ä»¥é—®è‡ªå·±å‡ ä¸ªé—®é¢˜ï¼š

1. ç»„ä»¶åº”è¯¥æ¥æ”¶ä»€ä¹ˆå‚æ•°ï¼Ÿ
2. ä½ æƒ³åŒ…å«ä»€ä¹ˆé€‰é¡¹ï¼Ÿ
3. ç»„ä»¶æƒ³è¿”å›ä»€ä¹ˆï¼Ÿ
4. æˆ‘ä»¬æƒ³è¦ä½¿ç”¨åŠ¨æ€è¿”å›å€¼å—ï¼Ÿ
5. å¦‚ä½•è¾¾åˆ°æœ€å°å¯ç”¨ç‰ˆæœ¬ï¼Œå¦‚ä½•å¿«é€Ÿå®ç°ï¼Ÿ
6. æœ€ç»ˆç‰ˆæœ¬ä¼šä»€ä¹ˆæ ·ï¼Ÿæˆ‘ä»¬èƒ½åšå“ªäº›ç®€å•çš„å‡†å¤‡ï¼Ÿ

å½“ç„¶ï¼Œä½ çš„ç»„ä»¶ä¼šéšç€å‘å±•å‘ç”Ÿå˜åŒ–ã€‚

ä½†ä¸€å¼€å§‹å°±æœç€æ­£ç¡®çš„æ–¹å‘å¼€å§‹ä¼šæ›´å®¹æ˜“ã€‚

## ğŸ”¥ Nuxt çš„å†…å®¹æŸ¥è¯¢

`Nuxt Content 2` ç»™æˆ‘ä»¬å¸¦æ¥äº†ä¸€ç§ `queryContent` çš„æ–¹æ³•æŸ¥è¯¢å†…å®¹ï¼š

```javascript
// composables/useArticles.js

export default () =>
  queryContent("articles")
    .where({
      // å¯é€‰å­—æ®µï¼Œå¯èƒ½ä¸º true æˆ–è€…ä¸å­˜åœ¨
      ghost: { $ne: true },
      newsletter: { $ne: true },
      // ä¸è¦æ¸²æŸ“æœªæ¥è®¡åˆ’å‘å¸ƒçš„æ–‡ç« 
      date: { $lte: new Date() },
    })
    .only(["title", "path", "description", "date", "tags"])
    .sort({ date: -1 })
    .find();
```

åœ¨è¿™æ®µä»£ç é‡Œï¼Œæˆ‘ç»™åšå®¢ç¼–å†™äº†ä¸€æ®µå¯å¤ç”¨çš„é€»è¾‘ `useArticles`ï¼Œå¯ä»¥æŠ“å– `content/articles` æ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰å†…å®¹ã€‚

`queryContent` å‡½æ•°æ˜¯ä¸€æ®µæŸ¥è¯¢é€»è¾‘ï¼Œå±•ç¤ºäº†å¦‚ä½•è·å–æ•°æ®ã€‚æˆ‘ä»¬æ¥ç€çœ‹æ˜¯å¦‚ä½•ä½¿ç”¨å®ƒçš„ã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬ä½¿ç”¨ `where` è¯­å¥æ¥ç­›é€‰å‡ºæˆ‘ä»¬ä¸å¸Œæœ›å‡ºç°çš„æ–‡ç« ã€‚æœ‰æ—¶å€™æˆ‘ä¼šåœ¨å‘å¸ƒç½‘ç«™ä¹‹å‰æ·»åŠ ä¸€ç¯‡æ–‡ç« ã€‚

æˆ‘è®¾å®šäº† `date` æ¡ä»¶ç­›é€‰æ‰æœªæ¥çš„æ—¥æœŸï¼Œæ¥è·å–ä»Šå¤©ä¹‹å‰çš„æ–‡ç« ï¼š

```javascript
date: {
  $lte: new Date();
}
```

ä¹‹åï¼Œæœ‰äº›æ–‡ç« æ˜¯æˆ‘æ¯å‘¨çš„å‘¨åˆŠå†…å®¹ï¼Œè¿˜æœ‰ä¸€äº›å†…å®¹æ˜¯æƒ³å½’å…¥ `articles` æ–‡ä»¶å¤¹ä½†è¿˜ä¸æƒ³å‘å¸ƒçš„å†…å®¹ã€‚

æˆ‘ä½¿ç”¨ frontmatter å­—æ®µæ¥æŒ‡å®šï¼š

```
---
newsletter: true  # This is a newsletter
---
```

```
---
ghost: true  # è¡¨ç¤ºä¸æƒ³å‡ºç°
---
```

ç¬¬ä¸‰æ­¥ï¼Œæˆ‘ä½¿ç”¨ `only` è¯­å¥æ¥æŠ“å–æˆ‘ä»¬æ‰€éœ€è¦çš„å­—æ®µã€‚é»˜è®¤æ¸…ç©ºä¸‹ï¼Œ`queryContent` æ–¹æ³•ä¼šè¿”å›å¾ˆå¤šæ•°æ®ï¼ŒåŒ…å«äº†æ–‡ç« æœ¬èº«ï¼Œè¿”å›çš„æ•°æ®é‡å¤ªå¤§äº†ã€‚

æœ€åï¼Œæˆ‘å·²ç»çŒœåˆ°äº†ï¼Œä½¿ç”¨ `sort` è¯­å¥æ¥å¯¹æ–‡ç« è¿›è¡Œæ—¥æœŸæ’åºã€‚

`queryContent` æ–¹æ³•æœ‰æ›´å¤šé€‰é¡¹ï¼Œå¯ä»¥è¿›ä¸€æ­¥é˜…è¯» [æ–‡æ¡£](https://content.nuxtjs.org/api/composables/query-content/)ã€‚

## ğŸ“œ å…¥é—¨ä»‹ç» Vue3 ä¸­çš„ Script Setup

åœ¨ Vue3 ä¸­ä½¿ç”¨ `script setup` ä¼šå‡å°‘ä¹¦å†™çš„ä»£ç ã€‚

ä½†å’Œä½¿ç”¨ `setup` ç›¸æ¯”è¿˜æ˜¯æœ‰ä¸€äº›ä¸åŒã€‚

Anthony Konstantinidis å†™çš„æ–‡ç« ä»‹ç»äº†æ‰€æœ‰ä½ åº”è¯¥çŸ¥é“çš„ Vue3 `script setup` ç»†èŠ‚ã€‚

è¿›ä¸€æ­¥é˜…è¯»ï¼š[The 101 guide to Script Setup in Vue 3](https://vuedose.tips/the-101-guide-to-script-setup-in-vue-3)

## ğŸ’¬ æ²¡æœ‰é”™è¯¯

"Testing can only prove the presence of bugs, not their absence." â€”Edsger W. Dijkstra

â€œæµ‹è¯•åªèƒ½è¯æ˜å­˜åœ¨ bugï¼Œè€Œä¸æ˜¯æ²¡æœ‰ bugã€‚â€ â€”Edsger W. Dijkstra

## ğŸ§  é—´éš”é‡å¤ï¼šæˆ‘æœ€å–œæ¬¢çš„ Git å‘½ä»¤

**æƒ³è¦é•¿æ—¶é—´ç‰¢ç‰¢è®°ä½æŸäº›äº‹æƒ…ï¼Œæœ€å¥½æ–¹å¼å°±æ˜¯å®šæœŸå›é¡¾ï¼Œé€æ¸å¢åŠ å›é¡¾çš„é—´éš” ğŸ‘¨â€ğŸ”¬**

**å®é™…ä¸Šï¼Œè®°ä½è¿™äº› tips æ¯”å‘å‘†æœ‰ç”¨å¾—å¤šï¼Œè¿™æ˜¯å‡ å‘¨å‰çš„ä¸€ä¸ª tip å¯ä»¥å”¤èµ·ä½ çš„è®°å¿†ã€‚**

ä»‹ç»ä¸€äº›æˆ‘æœ€å–œæ¬¢çš„ git å‘½ä»¤ï¼Œæˆ–è®¸ä½ ä¹Ÿæ˜¯å¦‚æ­¤ï¼š

æˆ‘ç»å¸¸åœ¨ä¸åŒåˆ†æ”¯ä¹‹é—´åˆ‡æ¢ï¼Œæ•²å‘½ä»¤å¾ˆéº»çƒ¦ï¼š

```sh
# åˆ‡æ¢åˆ°ä¸Šä¸€ä¸ªåˆ†æ”¯
git checkout -
```

åˆæ˜¯æˆ‘æ·»åŠ äº†ä¸€äº›ä¸´æ—¶æ–‡ä»¶ï¼Œä½†æˆ‘å‘ç°ä¸æ˜¯çœŸçš„éœ€è¦ä»–ä»¬ï¼š

```sh
# ç§»é™¤æ‰€æœ‰æ²¡æœ‰è¢«è¿½è¸ªçš„æ–‡ä»¶
git clean
```

æˆ–è€…æä¹±äº†ä»£ç ï¼Œéœ€è¦é‡æ–°å¼€å§‹ï¼š

```sh
# æ’¤é”€æ‰€æœ‰æ›´æ”¹ï¼Œå›åˆ°ä¸Šæ¬¡æäº¤
git reset --hard
```

Github ä¼šè·å– PR åˆ†æ”¯ä¸Šçš„æäº¤ï¼Œåˆå¹¶æ—¶å€™å¯ä»¥æŠŠä»–ä»¬åˆå¹¶åˆ°ä¸€æ¡è®°å½•ã€‚æˆ–è€…æƒ³åˆå¹¶ä¸€ä¸ªåˆ†æ”¯ï¼Œä½†è¿˜æ²¡å‡†å¤‡æ PRï¼š

```sh
# å‹ç¼©æ‰€æœ‰æäº¤åˆ°ä¸€æ¡æäº¤è®°å½•
git merge --squash <branch>
git commit
```

_p.s. I also have two courses: [Reusable Components](https://michaelnthiessen.com/reusable-components) and [Clean Components](https://michaelnthiessen.com/clean-components)_

## æ¥æº

åŸæ–‡ https://michaelnthiessen.com/weekly-073-august-10/

æœ¬ä½œå“é‡‡ç”¨[çŸ¥è¯†å…±äº«ç½²å-ç›¸åŒæ–¹å¼å…±äº« 4.0 å›½é™…è®¸å¯åè®®](http://creativecommons.org/licenses/by-sa/4.0/)è¿›è¡Œè®¸å¯ã€‚
